<div *ngIf="section" class="section-container">
    <div class="section">

        <!-- Parte superiore della section in cui verrà visualizzato il nome di essa -->
        <div class="section-name-container" (click)="showAccordion()">
            <p class="section-name">{{section.name.en || section.name.it}}</p>
        </div>
        <!-- Qui dentro verra visualizzato il form con dentro i vari field di input -->
        <!-- Show controlla se il corpo della section è visibile o meno, rimuovere
                ngIf per disabilitare-->
        <form *ngIf="show === true" novalidate class="field-container form">

            <!-- Viene creata una label e un input per ogni field -->
            <div *ngFor="let field of section.fields" class="field">



                <!--
                    Questo field viene mostrato solo se il fieldType è diverso da { "select" | "radio" | "checkbox" } 
                -->
                <div class="field-inner"
                    *ngIf="(field.fieldType != 'SELECT') && (field.fieldType != 'RADIO') && (field.fieldType != 'CHECKBOX') && (field.fieldType != 'TEXT_AREA')">
                    <label [for]="field.fieldName">{{field.label['en' || 'it']}}</label>
                    <input [type]="fieldTypeTranslator(field.fieldType)" [name]="field.fieldName" [id]="field.fieldName"
                        [formControl]="formArray.at(field.order)">
                </div>



                <!--
                    Questo field viene mostrato solo se il fieldType è "textarea"
                -->
                <div class="field-inner" *ngIf="(field.fieldType === 'TEXT_AREA')">
                    <label [for]="field.fieldName">{{field.label['en' || 'it']}}</label>
                    <textarea [name]="field.fieldName" [id]="field.fieldName" cols="50" rows="10"
                        [formControl]="formArray.at(field.order)"></textarea>
                </div>



                <!--
                    Questo field viene mostrato solo se il fieldType è "radio"
                    I vari radio input (dello stesso field) devono avere lo stesso [name] per funzionare
                -->
                <div class="field-inner"
                    *ngIf="(field.fieldType === 'RADIO' || fieldTypeTranslator(field.fieldType) === 'radio')"
                    class="radioInput">
                    <p>{{field.label.en}}</p>
                    <div *ngFor="let element of field.selectableItems; let i = index">
                        <input [type]="fieldTypeTranslator(field.fieldType)" [name]="field.fieldName" [value]="element"
                            [checked]="field.value.includes(element) ? 'true' : ''"
                            (change)="radioChange(field.order, element)">
                        <label [for]="field.fieldName">{{element}}</label>
                    </div>
                </div>


                <!--
                    Questo field viene mostrato solo se il fieldType è "checkbox"
                -->
                <div class="field-inner"
                    *ngIf="field.fieldType === 'CHECKBOX' || fieldTypeTranslator(field.fieldType) === 'checkbox'">
                    <div *ngFor="let element of field.selectableItems;">
                        <input [type]="fieldTypeTranslator(field.fieldType)" [name]="field.fieldName"
                            [value]="field.selectableItems"
                            [checked]="formArray.at(field.order).value?.includes(element) ? 'true' : ''"
                            (change)="checkBoxChange(element, formArray.at(field.order).value, field.order)">
                        <label [for]="field.fieldName">{{element}}</label>
                    </div>
                </div>


                
                <!--
                    Questo field viene mostrato solo se il fieldType è "select"
                -->
                <div class="field-inner"
                    *ngIf="((field.fieldType === 'SELECT') ||  fieldTypeTranslator(field.fieldType) === 'select')">
                    <label [for]="field.fieldName">{{field.label.en}}</label>
                    <select [formControl]="formArray.at(field.order)" [name]="field.fieldName">
                        <option *ngFor="let element of field.selectableItems" [value]="element">
                            {{element}}
                        </option>
                    </select>
                </div>
            </div>



            <div class="space-m"></div>

            <!-- Buttons con funzioni utili al utente:
                    Cancel - azzera i valori di tutti i campi
                    Reset - porta la section allo stato iniziale (valori arrivati dal server)
                    Save - Salva i dati del form se vengono rispettati i validators
                    TODO: disattivare il Save button se non tutti i campi sono validati correttamente 
            -->
            <div class="action-buttons-container">
                <input type="button" class="cancel_button" (click)="formArray.reset()" value="Cancel">
                <input type="button" class="reset_button" (click)="resetInitialValues(section)" value="Reset">
                <input type="button" class="save_button" (click)="showValues(section)" value="Save"
                    [disabled]="formArray.valid ? false : true">
            </div>
            <div class="space-m"></div>
        </form>
    </div>
</div>